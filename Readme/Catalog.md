# Каталог

Каталог товаров предназначен для просмотра карточек товаров с учётом возможных фильтров и сортировок.

---

В каталог можно попасть тремя способами:
- выбрав необходимую категорию товаров в списке возможных категорий (будут показаны товары с учётом дочерних категорий, при наличии таковых);
- через запрос в строке поиска (поиск будет осуществляться по наименованиям товаров, наименованиям категорий и тэгам);
- выбрав необходимый тэг на странице с детальным описанием товара (будут показаны все товары с данным тэгом, в независимости от их категорий и наименований);

---

Каталог состоит из следующих условно разделённых блоков:
1. блок возможных фильтров (для фильтрации товаров, попавших в первоначальную выборку) - для фильтрации,
настраиваем доступные фильтры на необходимые значения и далее нажимаем "Фильтр":
    - фильтр стоимости с возможностью управления ползунком (будут показаны товары, стоимость которых попадает в указанные пределы);
    - фильтр названия товара - текстовое поле (будут показаны товары, в наименовании которых есть указанная строка);
    - селект-фильтр по наименованию продавцоы товаров, которые попали в первоначальную выборку;
    - чекбокс "только в наличии" (активное состояние - будут показаны товары, количество которых строго больше нуля);
    - чекбокс "только ограниченные предложения" (активное состояние - будут показаны товары, имеющие активную скидку);
   

2. блок популярных тэгов (для фильтрации товаров, попавших в первоначальную выборку по тэгу) - для фильтрации
по выбранному тэгу необхоидмо кликнуть на выбранный тэг; клик по иному тэгу - отфильтрует выборку по данному тэгу;
повторный клик по уже активному тэгу приведет к отключению фильтрации по данному тэгу; активный тэг имеет синюю обводку;


3. блок возможных сортировок (для сортировки товаров, попавших в выборку) - при первом клике на кнопку сортировки,
будет произведена сортировка по возрастанию (по алфавиту в прямом порядке), 
при повторном клике - по убыванию (по алфавиту в обратном порядке):
   - по популярности - сортировка с учетом количества заказов товаров;
   - по стоимости - сортировка с учетом стоимости товаров;
   - по комментариям - сортировка с учетом количества комментариев у товара;
   - по имени - сортировка с учетом наименования товаров;
   - по новизне - сортировка с учетов даты внесения товара в БД;


4. блок отображения карточек товаров, попавших в выборку - список максимум их 8 карточек 
(в 2 ряда, по 4 в ряд)


5. блок пагинации - ряд кнопок, содержащий кнопку перехода на предыдущую страницу, кнопки номеров
доступных страниц и кнопку перехода на следующую страницу; если в выборку попадает большое количество
товаров, то некоторые номера будут заменены на неактивную кнопку "..." в начале, в конце или 
и в начале и в конеце;

---

Все запросы к серверу на любые фильтрации и сортировки реализованы через асинхронные get запросы с
фронтэнда через javascript. JS скрипт
- получает все необходимые параметры непосредственно со страницы;
- формирует запрос и отправляет его на сервер;
- получает в отвер json, по ключу 'html' в котором будет готовая строка разметки страницы;
- отрисовывает в заданной области страницы новую полученную разметку;


За обработку данных асинхронных запросов на сервере отвечает 
класс AllCardForAjax из goods_app/views.py:
- на вход получает get-запрос со всеми необходимыми,
для формирования выборки, параметрами;
- обрабатывает параметры, и формирует ответ в формате json с помощью JsonResponse из модуля django.http;
- в json-ответе по ключу 'html' хранится готовая для рендера разметка в виде простого текста
, которая была получена при помощи render_to_string из django.template.loader;