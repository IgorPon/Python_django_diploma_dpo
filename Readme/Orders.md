# Заказ и оплата

При нажатии на заказ из корзины, если пользователь не залогинен, он может зарегистрироваться или залогиниться.
В заказ попадают товары с финальной ценой после примененных скидок. На втором шаге оформления заказа выбирается
вид доставки, заполняется адрес и город

На третьем шаге выбирается способ оплаты: картой или рандомным счетом.
На четвертом шаге заказ получает статус оформлен. Выводится вся информация по заказу, сумма доставки и общая сумма с учетом доставки
Сумма доставки расчитывается исходя из финальной суммы заказа и типа доставки.

При выбранной оплате картой, предлагается ввести номер карты, CVV и дату действия карты. Оплата симулируется через сторонний сервис Braintree
При удачной оплате, происходит переход на страницу об успешной оплате и статус заказа меняется на "оплаченный"

При неудачной оплате, происходит переход на страницу об ошибке и заказ остается неоплаченным.

При оплате счетом, происходит валидация счета сервисом оплаты и аналогично как с картой.
Можно также обратится к сервису оплаты API запросом. Например из бота.

Есть две команды: получение статуса указанного заказа или оплата указанного заказа рандомным счетом
Валидация аналогична как при оплате с сайта.

Возможные статусы заказа: paid, not paid.
При отсутствии заказа с указанным номером, вместо статуса будет сообщение, что такого заказа нет.

Если оплата прошла, приходит сообщение: payment processed.
При любых ошибках валидации или отсутствии заказа с таким номером: payment not processed.
Демонстрация оформления.